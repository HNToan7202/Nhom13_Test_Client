{"ast":null,"code":"var _jsxFileName = \"/Users/hoangtoannguyen/HCMUTE/CCPTPM/Documents/video-editing/client/src/components/VideoInput/video-input.jsx\",\n  _s = $RefreshSig$();\nimport { useRef, useState, useEffect, useCallback } from \"react\";\nimport { HubConnectionBuilder, LogLevel } from \"@microsoft/signalr\";\nimport { Box, Button, Slider, TextField, Backdrop, CircularProgress, Snackbar, Alert, Grid, Dialog, DialogContent, DialogContentText, DialogActions } from \"@mui/material\";\nimport ReactPlayer from \"react-player\";\nimport videoEditingApi from \"../../api/video-editing\";\nimport { useLocation } from \"react-router-dom\";\nimport HighlightReview from \"../highlight-review\";\nimport TableEditVideo from \"./TableEditVideo\";\nimport TableReview from \"./TableReview\";\nimport { DialogDraggableLogo, DialogMoreEvent } from \"../flugin\";\nimport CustomizedSlider from \"./Silder\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const formatTimeSlice = time => {\n  var mind = time % (60 * 60);\n  var minutes = Math.floor(time / 60);\n  var secd = mind % 60;\n  var seconds = Math.ceil(secd);\n  return minutes + \":\" + (\"0\" + seconds).slice(-2);\n};\nconst VideoInput = () => {\n  _s();\n  const [bitrate, setBitrate] = useState(1000);\n  const [resolution, setResolution] = useState({\n    label: \"1080p\",\n    value: \"1920:1080\"\n  });\n  const [connection, setConnection] = useState();\n  const [opendialog, setOpenDialog] = useState(false);\n  const [hlSuccess, setHlSuccess] = useState();\n  const [downloadOneSuccess, setDownloadOneSuccess] = useState();\n  const location = useLocation();\n  const videoPlayer = useRef(null);\n  const descriptionElementRef = useRef(null);\n  const [rowSelected, setRowSelected] = useState();\n  const [hlDescription, setHlDescription] = useState(\"\");\n  const [noti, setNoti] = useState(false);\n  const [message, setMessage] = useState();\n  const [typeNoti, setTypeNoti] = useState();\n  const [videoSrc, setVideoSrc] = useState([]);\n  const [filtered, setFiltered] = useState([]);\n  const [dis, setDis] = useState(true);\n  const [duration, setDuration] = useState(0);\n  const [body, setBody] = useState();\n  const [videoPieceTime, setVideoPieceTime] = useState([0, 0]);\n  const previousVideoPieceTime = useRef(videoPieceTime);\n  const previousDataRow = useRef(rowSelected);\n  const [eventGallery, setEventGallery] = useState();\n  const [logoGallery, setLogoGallery] = useState();\n  const [opendialogUploadEvent, setOpendialogUploadEvent] = useState(false);\n  const [opendialogUploadLogo, setOpendialogUploadLogo] = useState(false);\n  const [typeDraggable, setTypeDraggable] = useState();\n  useEffect(() => {\n    previousVideoPieceTime.current = videoPieceTime;\n  }, [videoPieceTime]);\n  const [open, setOpen] = useState(false);\n  const [highlights, setHighlights] = useState();\n  const getHighlight = async () => {\n    try {\n      var response = await videoEditingApi.getHighlightOfMatch(location.state.row.id);\n      setHighlights(response.data);\n    } catch (error) {\n      console.log(error.response);\n    }\n  };\n  const join = async () => {\n    try {\n      const connection1 = new HubConnectionBuilder().withUrl(process.env.REACT_APP_BASE_NOTI_URL).configureLogging(LogLevel.Information).build();\n      connection1.on(\"noti\", (user, message) => {\n        setHlSuccess(JSON.parse(message));\n      });\n      connection1.on(\"background_no_merge\", (user, message) => {\n        setHlSuccess(JSON.parse(message));\n      });\n      connection1.on(\"download_one\", (user, message) => {\n        setDownloadOneSuccess(JSON.parse(message));\n      });\n      await connection1.start();\n      await connection1.invoke(\"JoinRoom\", {\n        username: localStorage.getItem(\"username\"),\n        room: localStorage.getItem(\"username\")\n      });\n      setConnection(connection1);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n  useEffect(() => {\n    if (hlSuccess) {\n      const temp = [...highlights];\n      const idx = temp.findIndex(hl => hl.id === hlSuccess.id);\n      temp[idx] = hlSuccess;\n      setHighlights(temp);\n    }\n  }, [hlSuccess]);\n  useEffect(() => {\n    if (downloadOneSuccess) {\n      setOpen(false);\n      setOpen(false);\n      // Create blob link to download\n      const link = document.createElement(\"a\");\n      link.href = downloadOneSuccess.replace(\"raw\", \"download\");\n      // Append to html link element page\n      document.body.appendChild(link);\n      // Start download\n      link.click();\n      // Clean up and remove the link\n      link.parentNode.removeChild(link);\n      setDownloadOneSuccess();\n    }\n  }, [downloadOneSuccess]);\n  useEffect(() => {\n    setVideoPieceTime([rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.startTime, rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.endTime]);\n    videoPlayer.current.seekTo((rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.mainpoint) - (rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.ts[0]), \"seconds\");\n  }, [rowSelected]);\n  useEffect(() => {\n    const a = filtered.filter(fil => {\n      if (fil.selected) {\n        return true;\n      }\n      return false;\n    }).length;\n    if (a > 0) {\n      setDis(false);\n    } else {\n      setDis(true);\n    }\n  }, [filtered]);\n  useEffect(() => {\n    const getData = async () => {\n      const response = await videoEditingApi.getMatchById({\n        Id: location.state.row.id\n      });\n      setBody(response.data.jsonFile);\n      setRowSelected(response.data.jsonFile.event[0]);\n      const temp = response.data.jsonFile.event;\n      if (response.data.jsonFile.event[0].selected === -1) {\n        const tempdata = {\n          ...response.data.jsonFile.event[0]\n        };\n        tempdata.selected = 1;\n        updateLogTrimmed(tempdata);\n        temp[0].selected = 1;\n      }\n      setVideoSrc(temp);\n    };\n    const getGallery = async () => {\n      try {\n        var eventG = [];\n        var logoG = [];\n        var responseL = await videoEditingApi.getGallery(0);\n        var responseE = await videoEditingApi.getGallery(1);\n        if (responseE.data.length > 0) {\n          responseE.data.forEach(element => {\n            const data = {\n              event: element.event,\n              file_name: element.file_name,\n              selected: -1,\n              logo: 0\n            };\n            eventG.push(data);\n          });\n        }\n        if (responseL.data.length > 0) {\n          responseL.data.forEach((element, index) => {\n            const data = {\n              label: element.event,\n              file_name: element.file_name,\n              position: {\n                x: 0,\n                y: 0\n              },\n              size: [Math.floor(element.width / 2), Math.floor(element.height / 2)],\n              selected: false\n            };\n            logoG.push(data);\n          });\n        }\n        setLogoGallery(logoG);\n        setEventGallery(eventG);\n      } catch {}\n    };\n    getGallery();\n    join();\n    getData();\n    getHighlight();\n    return async () => {\n      try {\n        await connection.stop();\n      } catch (e) {\n        console.log(e);\n      }\n    };\n  }, []);\n  const updateLogTrimmed = async eventUpdate => {\n    try {\n      await videoEditingApi.updateLogTrimmed(location.state.row.id, eventUpdate);\n    } catch (error) {}\n  };\n  const handleDuration = duration => {\n    const temp = {\n      ...previousDataRow.current\n    };\n    const sd = videoSrc.find(item => item.file_name === temp.file_name);\n    //send temp to update\n    updateLogTrimmed(sd);\n    previousDataRow.current = rowSelected;\n    setDuration(duration);\n  };\n  const handleSlideChange = (event, newValue) => {\n    let indexSeekTo;\n    if (newValue[0] !== previousVideoPieceTime.current[0]) indexSeekTo = 0;else indexSeekTo = 1;\n    setVideoPieceTime(newValue);\n    const newVideoSrc = [...videoSrc];\n    const a = {\n      ...rowSelected\n    };\n    a.startTime = newValue[0];\n    a.endTime = newValue[1];\n    const vdSrc = newVideoSrc.findIndex(vid => vid.file_name === a.file_name);\n    setRowSelected(a);\n    newVideoSrc[vdSrc] = a;\n    setVideoSrc(newVideoSrc);\n    videoPlayer.current.seekTo(newValue[indexSeekTo], \"seconds\");\n  };\n  const handelCheckLogo = (checked, logoSelected) => {\n    const temp = [...logoGallery];\n    const idx = temp.findIndex(item => item.file_name === logoSelected.file_name);\n    temp[idx].selected = checked;\n    setLogoGallery(temp);\n  };\n  const handleEditVideo = () => {\n    const temp = {\n      ...previousDataRow.current\n    };\n    updateLogTrimmed(temp);\n    const tempFilter = [...videoSrc];\n    const payload = tempFilter.reduce((filtered, video) => {\n      if (video.selected === 1) {\n        filtered.push(video);\n      }\n      return filtered;\n    }, []);\n    setFiltered(payload);\n    setOpenDialog(true);\n  };\n  const handleSendServer = e => {\n    e.preventDefault();\n    const temp = [...logoGallery];\n    const lggg = temp.reduce((logoSent, tempLogo) => {\n      if (tempLogo.selected) {\n        const logoSentItem = {\n          position: tempLogo.position,\n          file_name: tempLogo.file_name,\n          size: tempLogo.size\n        };\n        logoSent.push(logoSentItem);\n      }\n      return logoSent;\n    }, []);\n    const newBitrate = bitrate ? bitrate : \"1000\";\n    setBitrate(newBitrate);\n    const newBody = {\n      ...body,\n      event: filtered,\n      logo: lggg,\n      resolution: resolution.value,\n      bitrate: newBitrate.toString()\n    };\n    const concatHighlight = async () => {\n      try {\n        await videoEditingApi.concatHighlight(location.state.row.id, hlDescription, newBody);\n        setOpen(false);\n        setNoti(true);\n        setOpenDialog(false);\n        setMessage(\"Consolidation in progress\");\n        setTypeNoti(\"success\");\n        getHighlight();\n      } catch (error) {\n        setNoti(true);\n        setOpen(false);\n        setMessage(error.response.data.description);\n        setTypeNoti(\"error\");\n      }\n    };\n    setOpen(true);\n    concatHighlight();\n  };\n  const handleDownloadOneClick = () => {\n    const payload = [rowSelected];\n    const newBody = {\n      ...body,\n      event: payload,\n      logo: []\n    };\n    const downloadOne = async () => {\n      try {\n        await videoEditingApi.downloadOne(location.state.row.id, hlDescription, newBody);\n      } catch (error) {\n        setNoti(true);\n        setMessage(error.response.data.description);\n        setTypeNoti(\"error\");\n      }\n    };\n    setOpen(true);\n    downloadOne();\n  };\n  const downloadNoMerge = files => {\n    download_files(files);\n  };\n  function download_files(files) {\n    function download_next(i) {\n      if (i >= (files === null || files === void 0 ? void 0 : files.length)) {\n        return;\n      }\n      var link = document.createElement(\"a\");\n      document.body.appendChild(link);\n      link.setAttribute(\"href\", files[i].replace(\"raw\", \"download\"));\n      link.click();\n\n      // Delete the temporary link.\n      document.body.removeChild(link);\n      // Download the next file with a small timeout. The timeout is necessary\n      // for IE, which will otherwise only download the first file.\n      setTimeout(function () {\n        download_next(i + 1);\n      }, 2000);\n    }\n    // Initiate the first download.\n    download_next(0);\n  }\n  const handleSendServerNotMerge = () => {\n    const temp = [...logoGallery];\n    const lgg = temp.filter(l => l.position.x > 0);\n    const newBitrate = bitrate ? bitrate : \"1000\";\n    setBitrate(newBitrate);\n    const newBody = {\n      ...body,\n      event: filtered,\n      logo: lgg,\n      resolution: resolution.value,\n      bitrate: newBitrate.toString()\n    };\n    const downloadNotMerge = async () => {\n      try {\n        await videoEditingApi.downloadNotMerge(location.state.row.id, hlDescription, newBody);\n        setOpen(false);\n        setNoti(true);\n        setOpenDialog(false);\n        setMessage(\"Consolidation in progress\");\n        setTypeNoti(\"success\");\n        getHighlight();\n      } catch (error) {\n        setNoti(true);\n        setOpen(false);\n        setMessage(error);\n        setTypeNoti(\"error\");\n      }\n    };\n    setOpen(true);\n    downloadNotMerge();\n  };\n  const handleClose = () => {\n    setOpenDialog(false);\n    setOpendialogUploadEvent(false);\n    setOpendialogUploadLogo(false);\n  };\n  const handleClose1 = () => {\n    setOpendialogUploadEvent(false);\n    setOpendialogUploadLogo(false);\n  };\n  const onTableClick = row => {\n    setRowSelected(row);\n    const newVideoSrc = [...videoSrc];\n    const vdSrc = newVideoSrc.findIndex(vid => vid.file_name === row.file_name);\n    if (row.selected !== 1) {\n      newVideoSrc[vdSrc].selected = 1;\n    }\n    setVideoSrc(newVideoSrc);\n  };\n  const onCheckOne = (checked, record) => {\n    const newVideoSrc = [...videoSrc];\n    const vdSrc = newVideoSrc.findIndex(vid => vid.file_name === record.file_name);\n    newVideoSrc[vdSrc].selected = checked ? 1 : 0;\n    setVideoSrc(newVideoSrc);\n    updateLogTrimmed(newVideoSrc[vdSrc]);\n  };\n  const onCheckAll = (checked, filteredInfo) => {\n    var temp = [...videoSrc];\n    const payload = temp.reduce((filtered, video) => {\n      var tempVideo = {\n        ...video\n      };\n      if ((filteredInfo === null || filteredInfo === void 0 ? void 0 : filteredInfo.event) !== null || (filteredInfo === null || filteredInfo === void 0 ? void 0 : filteredInfo.level) !== null) {\n        if (filteredInfo.level !== null && filteredInfo.event !== null) {\n          if (filteredInfo.event.includes(tempVideo.event) && filteredInfo.level.includes(tempVideo.level)) {\n            tempVideo.selected = checked ? 1 : 0;\n            filtered.push(tempVideo);\n          } else {\n            tempVideo.selected = 0;\n            filtered.push(tempVideo);\n          }\n          return filtered;\n        } else if (filteredInfo.level === null) {\n          if (filteredInfo.event.includes(tempVideo.event)) {\n            tempVideo.selected = checked ? 1 : 0;\n            filtered.push(tempVideo);\n          } else {\n            tempVideo.selected = 0;\n            filtered.push(tempVideo);\n          }\n          return filtered;\n        } else {\n          if (filteredInfo.level.includes(tempVideo.level)) {\n            tempVideo.selected = checked ? 1 : 0;\n            filtered.push(tempVideo);\n          } else {\n            tempVideo.selected = 0;\n            filtered.push(tempVideo);\n          }\n          return filtered;\n        }\n      } else {\n        tempVideo.selected = checked ? 1 : 0;\n        filtered.push(tempVideo);\n        return filtered;\n      }\n    }, []);\n    setVideoSrc(payload);\n\n    // const updateAll = async () => {\n    //   try {\n    //     await videoEditingApi.updateAll(location.state.row.id, checked ? 1 : 0);\n    //   } catch (error) {}\n    // };\n    // updateAll();\n  };\n\n  const [isReady, setIsReady] = useState(false);\n  const onReady = useCallback(rowSelected => {\n    if (!isReady) {\n      const timeToStart = (rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.mainpoint) - (rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.ts[0]);\n      videoPlayer.current.seekTo(timeToStart, \"seconds\");\n      setIsReady(true);\n    }\n  }, [isReady]);\n  const onCheck = row => {\n    if (row.selected === 1) {\n      const temp = [...filtered];\n      temp.unshift(row);\n      setFiltered(temp);\n    } else {\n      const temp = [...filtered];\n      var newF = temp.filter(t => t.file_name !== row.file_name);\n      setFiltered(newF);\n    }\n  };\n  const handleIconRemoveEventClick = row => {\n    const temp = [...filtered];\n    const afterRemove = temp.filter(item => item.file_name !== row.file_name);\n    setFiltered(afterRemove);\n  };\n  const onTrack = (lg, newPos) => {\n    const temp = [...logoGallery];\n    const idx = temp.findIndex(l => l.file_name === lg.file_name);\n    temp[idx].position = newPos;\n    setLogoGallery(temp);\n  };\n  const onResize = (lg, newSize) => {\n    const temp = [...logoGallery];\n    const idx = temp.findIndex(l => l.file_name === lg.file_name);\n    let newNewSize = [...newSize];\n    newNewSize[1] = parseInt(newSize[0] * temp[idx].size[1] / temp[idx].size[0]);\n    temp[idx].size = newNewSize;\n    setLogoGallery(temp);\n  };\n  const handleCheckLogo = (row, e) => {\n    const temp = [...filtered];\n    const idx = temp.findIndex(l => l.file_name === row.file_name);\n    temp[idx].logo = e.target.checked ? 1 : 0;\n    setFiltered(temp);\n  };\n  const handleLogoCheckAll = e => {\n    const temp = [...filtered];\n    temp.forEach(item => {\n      item.logo = e.target.checked ? 1 : 0;\n    });\n    setFiltered(temp);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Backdrop, {\n      sx: {\n        color: \"#fff\",\n        zIndex: theme => theme.zIndex.drawer + 100000000\n      },\n      open: open,\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n        color: \"inherit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 594,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DialogMoreEvent, {\n      open: opendialogUploadEvent,\n      handleClose: handleClose1,\n      onCheck: onCheck,\n      eventGallery: eventGallery\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 597,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DialogDraggableLogo, {\n      fileName: filtered[0] ? filtered[0].file_name : \"\",\n      type: typeDraggable,\n      open: opendialogUploadLogo,\n      handleClose: handleClose1,\n      logo: logoGallery,\n      onTrack: onTrack,\n      onResize: onResize,\n      handelCheckLogo: handelCheckLogo\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 604,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: opendialog,\n      onClose: handleClose,\n      scroll: \"paper\",\n      fullScreen: true,\n      children: [/*#__PURE__*/_jsxDEV(DialogContent, {\n        dividers: true,\n        children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n          id: \"scroll-dialog-description\",\n          ref: descriptionElementRef,\n          tabIndex: -1,\n          minHeight: \"70vh\",\n          children: /*#__PURE__*/_jsxDEV(TableReview, {\n            data: filtered,\n            setData: setFiltered,\n            handleIconRemoveClick: handleIconRemoveEventClick,\n            logo: logoGallery,\n            onCheck: handleCheckLogo,\n            logoCheckAll: handleLogoCheckAll,\n            resolution: resolution,\n            bitrate: bitrate,\n            setResolution: setResolution,\n            setBitrate: setBitrate\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 617,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 616,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: /*#__PURE__*/_jsxDEV(Grid, {\n          sx: {\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\"\n          },\n          container: true,\n          component: \"form\",\n          onSubmit: handleSendServer,\n          children: [/*#__PURE__*/_jsxDEV(TextField, {\n            sx: {\n              width: \"50%\"\n            },\n            label: \"Enter description for video highlight\",\n            value: hlDescription,\n            onChange: e => setHlDescription(e.target.value),\n            multiline: true,\n            small: true,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 648,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              sx: {\n                backgroundColor: \"#996699\",\n                marginLeft: \"10px\"\n              },\n              variant: \"contained\",\n              onClick: () => {\n                setTypeDraggable(\"logo\");\n                setOpendialogUploadLogo(true);\n              },\n              children: \"Add Logo\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 672,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              sx: {\n                marginLeft: \"10px\",\n                backgroundColor: \"#996699\"\n              },\n              variant: \"contained\",\n              onClick: () => {\n                setOpendialogUploadEvent(true);\n              },\n              children: \"Add Event\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 685,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              sx: {\n                marginLeft: \"10px\",\n                backgroundColor: \"#002200\"\n              },\n              variant: \"contained\",\n              onClick: handleSendServerNotMerge,\n              disabled: dis,\n              children: \"Download\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 697,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              sx: {\n                marginLeft: \"10px\"\n              },\n              variant: \"contained\"\n              //onClick={handleSendServer}\n              ,\n              type: \"submit\",\n              disabled: dis,\n              children: \"Merge\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 708,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              sx: {\n                backgroundColor: \"red\",\n                marginLeft: \"10px\"\n              },\n              variant: \"contained\",\n              onClick: handleClose,\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 719,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 659,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 637,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 615,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n      anchorOrigin: {\n        vertical: \"top\",\n        horizontal: \"right\"\n      },\n      open: noti,\n      autoHideDuration: 5000,\n      onClose: () => setNoti(false),\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        onClose: () => setNoti(false),\n        severity: typeNoti,\n        sx: {\n          width: \"100%\"\n        },\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 740,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 734,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 7,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          display: \"flex\",\n          justifyContent: \"center\",\n          children: /*#__PURE__*/_jsxDEV(ReactPlayer, {\n            ref: videoPlayer,\n            url: rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.file_name,\n            onDuration: handleDuration,\n            controls: true,\n            onReady: () => onReady(rowSelected),\n            playing: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 752,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 751,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sx: {\n            display: \"flex\",\n            justifyContent: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: \"100%\",\n              maxWidth: \"720px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                display: \"flex\",\n                marginBottom: \"20px\",\n                marginTop: \"20px\"\n              },\n              children: /*#__PURE__*/_jsxDEV(CustomizedSlider, {\n                duration: duration,\n                videoPieceTime: videoPieceTime,\n                handleSlideChange: handleSlideChange\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 771,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 764,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              sx: {\n                marginBottom: 2,\n                display: \"flex\",\n                justifyContent: \"space-between\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: formatTimeSlice(rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.startTime)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 794,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: formatTimeSlice(rowSelected === null || rowSelected === void 0 ? void 0 : rowSelected.endTime)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 796,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 787,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 763,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 762,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 815,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 5,\n        overflow: \"auto\",\n        children: /*#__PURE__*/_jsxDEV(TableEditVideo, {\n          data: videoSrc,\n          height: \"55vh\",\n          onTableClick: onTableClick,\n          onCheckOne: onCheckOne,\n          onCheckAll: onCheckAll,\n          buttonReview: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            onClick: handleEditVideo,\n            children: \"Review\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 825,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 818,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 817,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 749,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        height: 3,\n        backgroundColor: \"black\",\n        marginBottom: \"15px\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 832,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(HighlightReview, {\n      getHighlight: getHighlight,\n      highlights: highlights,\n      mode: 1,\n      downloadNoMerge: downloadNoMerge\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 835,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(VideoInput, \"U7S6MMQ7h4baTAd0SaQ0AuR+eXY=\", false, function () {\n  return [useLocation];\n});\n_c = VideoInput;\nexport default VideoInput;\nvar _c;\n$RefreshReg$(_c, \"VideoInput\");","map":{"version":3,"names":["useRef","useState","useEffect","useCallback","HubConnectionBuilder","LogLevel","Box","Button","Slider","TextField","Backdrop","CircularProgress","Snackbar","Alert","Grid","Dialog","DialogContent","DialogContentText","DialogActions","ReactPlayer","videoEditingApi","useLocation","HighlightReview","TableEditVideo","TableReview","DialogDraggableLogo","DialogMoreEvent","CustomizedSlider","jsxDEV","_jsxDEV","Fragment","_Fragment","formatTimeSlice","time","mind","minutes","Math","floor","secd","seconds","ceil","slice","VideoInput","_s","bitrate","setBitrate","resolution","setResolution","label","value","connection","setConnection","opendialog","setOpenDialog","hlSuccess","setHlSuccess","downloadOneSuccess","setDownloadOneSuccess","location","videoPlayer","descriptionElementRef","rowSelected","setRowSelected","hlDescription","setHlDescription","noti","setNoti","message","setMessage","typeNoti","setTypeNoti","videoSrc","setVideoSrc","filtered","setFiltered","dis","setDis","duration","setDuration","body","setBody","videoPieceTime","setVideoPieceTime","previousVideoPieceTime","previousDataRow","eventGallery","setEventGallery","logoGallery","setLogoGallery","opendialogUploadEvent","setOpendialogUploadEvent","opendialogUploadLogo","setOpendialogUploadLogo","typeDraggable","setTypeDraggable","current","open","setOpen","highlights","setHighlights","getHighlight","response","getHighlightOfMatch","state","row","id","data","error","console","log","join","connection1","withUrl","process","env","REACT_APP_BASE_NOTI_URL","configureLogging","Information","build","on","user","JSON","parse","start","invoke","username","localStorage","getItem","room","e","temp","idx","findIndex","hl","link","document","createElement","href","replace","appendChild","click","parentNode","removeChild","startTime","endTime","seekTo","mainpoint","ts","a","filter","fil","selected","length","getData","getMatchById","Id","jsonFile","event","tempdata","updateLogTrimmed","getGallery","eventG","logoG","responseL","responseE","forEach","element","file_name","logo","push","index","position","x","y","size","width","height","stop","eventUpdate","handleDuration","sd","find","item","handleSlideChange","newValue","indexSeekTo","newVideoSrc","vdSrc","vid","handelCheckLogo","checked","logoSelected","handleEditVideo","tempFilter","payload","reduce","video","handleSendServer","preventDefault","lggg","logoSent","tempLogo","logoSentItem","newBitrate","newBody","toString","concatHighlight","description","handleDownloadOneClick","downloadOne","downloadNoMerge","files","download_files","download_next","i","setAttribute","setTimeout","handleSendServerNotMerge","lgg","l","downloadNotMerge","handleClose","handleClose1","onTableClick","onCheckOne","record","onCheckAll","filteredInfo","tempVideo","level","includes","isReady","setIsReady","onReady","timeToStart","onCheck","unshift","newF","t","handleIconRemoveEventClick","afterRemove","onTrack","lg","newPos","onResize","newSize","newNewSize","parseInt","handleCheckLogo","target","handleLogoCheckAll","children","sx","color","zIndex","theme","drawer","fileName","_jsxFileName","lineNumber","columnNumber","type","onClose","scroll","fullScreen","dividers","ref","tabIndex","minHeight","setData","handleIconRemoveClick","logoCheckAll","display","justifyContent","alignItems","container","component","onSubmit","onChange","multiline","small","required","backgroundColor","marginLeft","variant","onClick","disabled","anchorOrigin","vertical","horizontal","autoHideDuration","severity","spacing","xs","url","onDuration","controls","playing","style","maxWidth","marginBottom","marginTop","overflow","buttonReview","mode","_c","$RefreshReg$"],"sources":["/Users/hoangtoannguyen/HCMUTE/CCPTPM/Documents/video-editing/client/src/components/VideoInput/video-input.jsx"],"sourcesContent":["import { useRef, useState, useEffect, useCallback } from \"react\";\nimport { HubConnectionBuilder, LogLevel } from \"@microsoft/signalr\";\nimport {\n  Box,\n  Button,\n  Slider,\n  TextField,\n  Backdrop,\n  CircularProgress,\n  Snackbar,\n  Alert,\n  Grid,\n  Dialog,\n  DialogContent,\n  DialogContentText,\n  DialogActions,\n} from \"@mui/material\";\nimport ReactPlayer from \"react-player\";\nimport videoEditingApi from \"../../api/video-editing\";\nimport { useLocation } from \"react-router-dom\";\nimport HighlightReview from \"../highlight-review\";\nimport TableEditVideo from \"./TableEditVideo\";\nimport TableReview from \"./TableReview\";\nimport { DialogDraggableLogo, DialogMoreEvent } from \"../flugin\";\nimport CustomizedSlider from \"./Silder\";\n\nexport const formatTimeSlice = (time) => {\n  var mind = time % (60 * 60);\n  var minutes = Math.floor(time / 60);\n\n  var secd = mind % 60;\n  var seconds = Math.ceil(secd);\n  return minutes + \":\" + (\"0\" + seconds).slice(-2);\n};\n\nconst VideoInput = () => {\n  const [bitrate, setBitrate] = useState(1000);\n  const [resolution, setResolution] = useState({\n    label: \"1080p\",\n    value: \"1920:1080\",\n  });\n\n  const [connection, setConnection] = useState();\n  const [opendialog, setOpenDialog] = useState(false);\n\n  const [hlSuccess, setHlSuccess] = useState();\n  const [downloadOneSuccess, setDownloadOneSuccess] = useState();\n  const location = useLocation();\n  const videoPlayer = useRef(null);\n\n  const descriptionElementRef = useRef(null);\n  const [rowSelected, setRowSelected] = useState();\n\n  const [hlDescription, setHlDescription] = useState(\"\");\n  const [noti, setNoti] = useState(false);\n  const [message, setMessage] = useState();\n  const [typeNoti, setTypeNoti] = useState();\n  const [videoSrc, setVideoSrc] = useState([]);\n  const [filtered, setFiltered] = useState([]);\n  const [dis, setDis] = useState(true);\n  const [duration, setDuration] = useState(0);\n\n  const [body, setBody] = useState();\n  const [videoPieceTime, setVideoPieceTime] = useState([0, 0]);\n  const previousVideoPieceTime = useRef(videoPieceTime);\n  const previousDataRow = useRef(rowSelected);\n\n  const [eventGallery, setEventGallery] = useState();\n  const [logoGallery, setLogoGallery] = useState();\n  const [opendialogUploadEvent, setOpendialogUploadEvent] = useState(false);\n  const [opendialogUploadLogo, setOpendialogUploadLogo] = useState(false);\n  const [typeDraggable, setTypeDraggable] = useState();\n\n  useEffect(() => {\n    previousVideoPieceTime.current = videoPieceTime;\n  }, [videoPieceTime]);\n  const [open, setOpen] = useState(false);\n\n  const [highlights, setHighlights] = useState();\n\n  const getHighlight = async () => {\n    try {\n      var response = await videoEditingApi.getHighlightOfMatch(\n        location.state.row.id\n      );\n      setHighlights(response.data);\n    } catch (error) {\n      console.log(error.response);\n    }\n  };\n  const join = async () => {\n    try {\n      const connection1 = new HubConnectionBuilder()\n        .withUrl(process.env.REACT_APP_BASE_NOTI_URL)\n        .configureLogging(LogLevel.Information)\n        .build();\n\n      connection1.on(\"noti\", (user, message) => {\n        setHlSuccess(JSON.parse(message));\n      });\n\n      connection1.on(\"background_no_merge\", (user, message) => {\n        setHlSuccess(JSON.parse(message));\n      });\n\n      connection1.on(\"download_one\", (user, message) => {\n        setDownloadOneSuccess(JSON.parse(message));\n      });\n\n      await connection1.start();\n      await connection1.invoke(\"JoinRoom\", {\n        username: localStorage.getItem(\"username\"),\n        room: localStorage.getItem(\"username\"),\n      });\n      setConnection(connection1);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  useEffect(() => {\n    if (hlSuccess) {\n      const temp = [...highlights];\n      const idx = temp.findIndex((hl) => hl.id === hlSuccess.id);\n      temp[idx] = hlSuccess;\n      setHighlights(temp);\n    }\n  }, [hlSuccess]);\n\n  useEffect(() => {\n    if (downloadOneSuccess) {\n      setOpen(false);\n      setOpen(false);\n      // Create blob link to download\n      const link = document.createElement(\"a\");\n      link.href = downloadOneSuccess.replace(\"raw\", \"download\");\n      // Append to html link element page\n      document.body.appendChild(link);\n      // Start download\n      link.click();\n      // Clean up and remove the link\n      link.parentNode.removeChild(link);\n      setDownloadOneSuccess();\n    }\n  }, [downloadOneSuccess]);\n\n  useEffect(() => {\n    setVideoPieceTime([rowSelected?.startTime, rowSelected?.endTime]);\n    videoPlayer.current.seekTo(\n      rowSelected?.mainpoint - rowSelected?.ts[0],\n      \"seconds\"\n    );\n  }, [rowSelected]);\n\n  useEffect(() => {\n    const a = filtered.filter((fil) => {\n      if (fil.selected) {\n        return true;\n      }\n      return false;\n    }).length;\n    if (a > 0) {\n      setDis(false);\n    } else {\n      setDis(true);\n    }\n  }, [filtered]);\n\n  useEffect(() => {\n    const getData = async () => {\n      const response = await videoEditingApi.getMatchById({\n        Id: location.state.row.id,\n      });\n\n      setBody(response.data.jsonFile);\n\n      setRowSelected(response.data.jsonFile.event[0]);\n      const temp = response.data.jsonFile.event;\n\n      if (response.data.jsonFile.event[0].selected === -1) {\n        const tempdata = { ...response.data.jsonFile.event[0] };\n        tempdata.selected = 1;\n        updateLogTrimmed(tempdata);\n        temp[0].selected = 1;\n      }\n\n      setVideoSrc(temp);\n    };\n\n    const getGallery = async () => {\n      try {\n        var eventG = [];\n        var logoG = [];\n        var responseL = await videoEditingApi.getGallery(0);\n        var responseE = await videoEditingApi.getGallery(1);\n        if (responseE.data.length > 0) {\n          responseE.data.forEach((element) => {\n            const data = {\n              event: element.event,\n              file_name: element.file_name,\n              selected: -1,\n              logo: 0,\n            };\n            eventG.push(data);\n          });\n        }\n        if (responseL.data.length > 0) {\n          responseL.data.forEach((element, index) => {\n            const data = {\n              label: element.event,\n              file_name: element.file_name,\n              position: { x: 0, y: 0 },\n              size: [\n                Math.floor(element.width / 2),\n                Math.floor(element.height / 2),\n              ],\n              selected: false,\n            };\n            logoG.push(data);\n          });\n        }\n        setLogoGallery(logoG);\n        setEventGallery(eventG);\n      } catch {}\n    };\n    getGallery();\n    join();\n    getData();\n    getHighlight();\n    return async () => {\n      try {\n        await connection.stop();\n      } catch (e) {\n        console.log(e);\n      }\n    };\n  }, []);\n  const updateLogTrimmed = async (eventUpdate) => {\n    try {\n      await videoEditingApi.updateLogTrimmed(\n        location.state.row.id,\n        eventUpdate\n      );\n    } catch (error) {}\n  };\n\n  const handleDuration = (duration) => {\n    const temp = { ...previousDataRow.current };\n    const sd = videoSrc.find((item) => item.file_name === temp.file_name);\n    //send temp to update\n    updateLogTrimmed(sd);\n    previousDataRow.current = rowSelected;\n    setDuration(duration);\n  };\n\n  const handleSlideChange = (event, newValue) => {\n    let indexSeekTo;\n    if (newValue[0] !== previousVideoPieceTime.current[0]) indexSeekTo = 0;\n    else indexSeekTo = 1;\n    setVideoPieceTime(newValue);\n    const newVideoSrc = [...videoSrc];\n    const a = { ...rowSelected };\n    a.startTime = newValue[0];\n    a.endTime = newValue[1];\n    const vdSrc = newVideoSrc.findIndex((vid) => vid.file_name === a.file_name);\n    setRowSelected(a);\n    newVideoSrc[vdSrc] = a;\n    setVideoSrc(newVideoSrc);\n    videoPlayer.current.seekTo(newValue[indexSeekTo], \"seconds\");\n  };\n\n  const handelCheckLogo = (checked, logoSelected) => {\n    const temp = [...logoGallery];\n    const idx = temp.findIndex(\n      (item) => item.file_name === logoSelected.file_name\n    );\n    temp[idx].selected = checked;\n    setLogoGallery(temp);\n  };\n\n  const handleEditVideo = () => {\n    const temp = { ...previousDataRow.current };\n    updateLogTrimmed(temp);\n\n    const tempFilter = [...videoSrc];\n    const payload = tempFilter.reduce((filtered, video) => {\n      if (video.selected === 1) {\n        filtered.push(video);\n      }\n      return filtered;\n    }, []);\n    setFiltered(payload);\n    setOpenDialog(true);\n  };\n\n  const handleSendServer = (e) => {\n    e.preventDefault();\n    const temp = [...logoGallery];\n\n    const lggg = temp.reduce((logoSent, tempLogo) => {\n      if (tempLogo.selected) {\n        const logoSentItem = {\n          position: tempLogo.position,\n          file_name: tempLogo.file_name,\n          size: tempLogo.size,\n        };\n        logoSent.push(logoSentItem);\n      }\n      return logoSent;\n    }, []);\n\n    const newBitrate = bitrate ? bitrate : \"1000\";\n    setBitrate(newBitrate);\n    const newBody = {\n      ...body,\n      event: filtered,\n      logo: lggg,\n      resolution: resolution.value,\n      bitrate: newBitrate.toString(),\n    };\n    const concatHighlight = async () => {\n      try {\n        await videoEditingApi.concatHighlight(\n          location.state.row.id,\n          hlDescription,\n          newBody\n        );\n        setOpen(false);\n        setNoti(true);\n        setOpenDialog(false);\n        setMessage(\"Consolidation in progress\");\n        setTypeNoti(\"success\");\n        getHighlight();\n      } catch (error) {\n        setNoti(true);\n        setOpen(false);\n        setMessage(error.response.data.description);\n        setTypeNoti(\"error\");\n      }\n    };\n    setOpen(true);\n    concatHighlight();\n  };\n\n  const handleDownloadOneClick = () => {\n    const payload = [rowSelected];\n    const newBody = {\n      ...body,\n      event: payload,\n      logo: [],\n    };\n\n    const downloadOne = async () => {\n      try {\n        await videoEditingApi.downloadOne(\n          location.state.row.id,\n          hlDescription,\n          newBody\n        );\n      } catch (error) {\n        setNoti(true);\n        setMessage(error.response.data.description);\n        setTypeNoti(\"error\");\n      }\n    };\n    setOpen(true);\n    downloadOne();\n  };\n\n  const downloadNoMerge = (files) => {\n    download_files(files);\n  };\n\n  function download_files(files) {\n    function download_next(i) {\n      if (i >= files?.length) {\n        return;\n      }\n      var link = document.createElement(\"a\");\n      document.body.appendChild(link);\n      link.setAttribute(\"href\", files[i].replace(\"raw\", \"download\"));\n      link.click();\n\n      // Delete the temporary link.\n      document.body.removeChild(link);\n      // Download the next file with a small timeout. The timeout is necessary\n      // for IE, which will otherwise only download the first file.\n      setTimeout(function () {\n        download_next(i + 1);\n      }, 2000);\n    }\n    // Initiate the first download.\n    download_next(0);\n  }\n\n  const handleSendServerNotMerge = () => {\n    const temp = [...logoGallery];\n    const lgg = temp.filter((l) => l.position.x > 0);\n\n    const newBitrate = bitrate ? bitrate : \"1000\";\n    setBitrate(newBitrate);\n    const newBody = {\n      ...body,\n      event: filtered,\n      logo: lgg,\n      resolution: resolution.value,\n      bitrate: newBitrate.toString(),\n    };\n\n    const downloadNotMerge = async () => {\n      try {\n        await videoEditingApi.downloadNotMerge(\n          location.state.row.id,\n          hlDescription,\n          newBody\n        );\n        setOpen(false);\n        setNoti(true);\n        setOpenDialog(false);\n        setMessage(\"Consolidation in progress\");\n        setTypeNoti(\"success\");\n        getHighlight();\n      } catch (error) {\n        setNoti(true);\n        setOpen(false);\n        setMessage(error);\n        setTypeNoti(\"error\");\n      }\n    };\n    setOpen(true);\n    downloadNotMerge();\n  };\n\n  const handleClose = () => {\n    setOpenDialog(false);\n    setOpendialogUploadEvent(false);\n    setOpendialogUploadLogo(false);\n  };\n\n  const handleClose1 = () => {\n    setOpendialogUploadEvent(false);\n    setOpendialogUploadLogo(false);\n  };\n\n  const onTableClick = (row) => {\n    setRowSelected(row);\n    const newVideoSrc = [...videoSrc];\n    const vdSrc = newVideoSrc.findIndex(\n      (vid) => vid.file_name === row.file_name\n    );\n    if (row.selected !== 1) {\n      newVideoSrc[vdSrc].selected = 1;\n    }\n    setVideoSrc(newVideoSrc);\n  };\n\n  const onCheckOne = (checked, record) => {\n    const newVideoSrc = [...videoSrc];\n    const vdSrc = newVideoSrc.findIndex(\n      (vid) => vid.file_name === record.file_name\n    );\n    newVideoSrc[vdSrc].selected = checked ? 1 : 0;\n    setVideoSrc(newVideoSrc);\n    updateLogTrimmed(newVideoSrc[vdSrc]);\n  };\n\n  const onCheckAll = (checked, filteredInfo) => {\n    var temp = [...videoSrc];\n    const payload = temp.reduce((filtered, video) => {\n      var tempVideo = { ...video };\n\n      if (filteredInfo?.event !== null || filteredInfo?.level !== null) {\n        if (filteredInfo.level !== null && filteredInfo.event !== null) {\n          if (\n            filteredInfo.event.includes(tempVideo.event) &&\n            filteredInfo.level.includes(tempVideo.level)\n          ) {\n            tempVideo.selected = checked ? 1 : 0;\n            filtered.push(tempVideo);\n          } else {\n            tempVideo.selected = 0;\n            filtered.push(tempVideo);\n          }\n          return filtered;\n        } else if (filteredInfo.level === null) {\n          if (filteredInfo.event.includes(tempVideo.event)) {\n            tempVideo.selected = checked ? 1 : 0;\n            filtered.push(tempVideo);\n          } else {\n            tempVideo.selected = 0;\n            filtered.push(tempVideo);\n          }\n          return filtered;\n        } else {\n          if (filteredInfo.level.includes(tempVideo.level)) {\n            tempVideo.selected = checked ? 1 : 0;\n            filtered.push(tempVideo);\n          } else {\n            tempVideo.selected = 0;\n            filtered.push(tempVideo);\n          }\n          return filtered;\n        }\n      } else {\n        tempVideo.selected = checked ? 1 : 0;\n        filtered.push(tempVideo);\n        return filtered;\n      }\n    }, []);\n\n    setVideoSrc(payload);\n\n    // const updateAll = async () => {\n    //   try {\n    //     await videoEditingApi.updateAll(location.state.row.id, checked ? 1 : 0);\n    //   } catch (error) {}\n    // };\n    // updateAll();\n  };\n\n  const [isReady, setIsReady] = useState(false);\n  const onReady = useCallback(\n    (rowSelected) => {\n      if (!isReady) {\n        const timeToStart = rowSelected?.mainpoint - rowSelected?.ts[0];\n        videoPlayer.current.seekTo(timeToStart, \"seconds\");\n        setIsReady(true);\n      }\n    },\n    [isReady]\n  );\n\n  const onCheck = (row) => {\n    if (row.selected === 1) {\n      const temp = [...filtered];\n      temp.unshift(row);\n      setFiltered(temp);\n    } else {\n      const temp = [...filtered];\n      var newF = temp.filter((t) => t.file_name !== row.file_name);\n      setFiltered(newF);\n    }\n  };\n\n  const handleIconRemoveEventClick = (row) => {\n    const temp = [...filtered];\n    const afterRemove = temp.filter((item) => item.file_name !== row.file_name);\n\n    setFiltered(afterRemove);\n  };\n\n  const onTrack = (lg, newPos) => {\n    const temp = [...logoGallery];\n    const idx = temp.findIndex((l) => l.file_name === lg.file_name);\n    temp[idx].position = newPos;\n    setLogoGallery(temp);\n  };\n\n  const onResize = (lg, newSize) => {\n    const temp = [...logoGallery];\n    const idx = temp.findIndex((l) => l.file_name === lg.file_name);\n    let newNewSize = [...newSize];\n    newNewSize[1] = parseInt(\n      (newSize[0] * temp[idx].size[1]) / temp[idx].size[0]\n    );\n    temp[idx].size = newNewSize;\n    setLogoGallery(temp);\n  };\n\n  const handleCheckLogo = (row, e) => {\n    const temp = [...filtered];\n    const idx = temp.findIndex((l) => l.file_name === row.file_name);\n    temp[idx].logo = e.target.checked ? 1 : 0;\n    setFiltered(temp);\n  };\n\n  const handleLogoCheckAll = (e) => {\n    const temp = [...filtered];\n    temp.forEach((item) => {\n      item.logo = e.target.checked ? 1 : 0;\n    });\n    setFiltered(temp);\n  };\n\n  return (\n    <>\n      <Backdrop\n        sx={{\n          color: \"#fff\",\n          zIndex: (theme) => theme.zIndex.drawer + 100000000,\n        }}\n        open={open}\n      >\n        <CircularProgress color=\"inherit\" />\n      </Backdrop>\n\n      <DialogMoreEvent\n        open={opendialogUploadEvent}\n        handleClose={handleClose1}\n        onCheck={onCheck}\n        eventGallery={eventGallery}\n      />\n\n      <DialogDraggableLogo\n        fileName={filtered[0] ? filtered[0].file_name : \"\"}\n        type={typeDraggable}\n        open={opendialogUploadLogo}\n        handleClose={handleClose1}\n        logo={logoGallery}\n        onTrack={onTrack}\n        onResize={onResize}\n        handelCheckLogo={handelCheckLogo}\n      />\n\n      <Dialog open={opendialog} onClose={handleClose} scroll=\"paper\" fullScreen>\n        <DialogContent dividers={true}>\n          <DialogContentText\n            id=\"scroll-dialog-description\"\n            ref={descriptionElementRef}\n            tabIndex={-1}\n            minHeight=\"70vh\"\n          >\n            <TableReview\n              data={filtered}\n              setData={setFiltered}\n              handleIconRemoveClick={handleIconRemoveEventClick}\n              logo={logoGallery}\n              onCheck={handleCheckLogo}\n              logoCheckAll={handleLogoCheckAll}\n              resolution={resolution}\n              bitrate={bitrate}\n              setResolution={setResolution}\n              setBitrate={setBitrate}\n            />\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Grid\n            sx={{\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\",\n            }}\n            container\n            component=\"form\"\n            onSubmit={handleSendServer}\n          >\n            <TextField\n              sx={{\n                width: \"50%\",\n              }}\n              label=\"Enter description for video highlight\"\n              value={hlDescription}\n              onChange={(e) => setHlDescription(e.target.value)}\n              multiline\n              small\n              required\n            />\n            <div>\n              {/* <Button\n                sx={{\n                  backgroundColor: \"#996699\",\n                }}\n                variant=\"contained\"\n                onClick={() => {\n                  setTypeDraggable(\"frame\");\n                  setOpendialogUploadLogo(true);\n                }}\n              >\n                Add Frame\n              </Button> */}\n              <Button\n                sx={{\n                  backgroundColor: \"#996699\",\n                  marginLeft: \"10px\",\n                }}\n                variant=\"contained\"\n                onClick={() => {\n                  setTypeDraggable(\"logo\");\n                  setOpendialogUploadLogo(true);\n                }}\n              >\n                Add Logo\n              </Button>\n              <Button\n                sx={{\n                  marginLeft: \"10px\",\n                  backgroundColor: \"#996699\",\n                }}\n                variant=\"contained\"\n                onClick={() => {\n                  setOpendialogUploadEvent(true);\n                }}\n              >\n                Add Event\n              </Button>\n              <Button\n                sx={{\n                  marginLeft: \"10px\",\n                  backgroundColor: \"#002200\",\n                }}\n                variant=\"contained\"\n                onClick={handleSendServerNotMerge}\n                disabled={dis}\n              >\n                Download\n              </Button>\n              <Button\n                sx={{\n                  marginLeft: \"10px\",\n                }}\n                variant=\"contained\"\n                //onClick={handleSendServer}\n                type=\"submit\"\n                disabled={dis}\n              >\n                Merge\n              </Button>\n              <Button\n                sx={{\n                  backgroundColor: \"red\",\n                  marginLeft: \"10px\",\n                }}\n                variant=\"contained\"\n                onClick={handleClose}\n              >\n                Cancel\n              </Button>\n            </div>\n          </Grid>\n        </DialogActions>\n      </Dialog>\n\n      <Snackbar\n        anchorOrigin={{ vertical: \"top\", horizontal: \"right\" }}\n        open={noti}\n        autoHideDuration={5000}\n        onClose={() => setNoti(false)}\n      >\n        <Alert\n          onClose={() => setNoti(false)}\n          severity={typeNoti}\n          sx={{ width: \"100%\" }}\n        >\n          {message}\n        </Alert>\n      </Snackbar>\n\n      <Grid container spacing={2}>\n        <Grid item xs={7}>\n          <Grid item xs={12} display=\"flex\" justifyContent=\"center\">\n            <ReactPlayer\n              ref={videoPlayer}\n              url={rowSelected?.file_name}\n              onDuration={handleDuration}\n              controls\n              onReady={() => onReady(rowSelected)}\n              playing={true}\n            />\n          </Grid>\n\n          <Grid item xs={12} sx={{ display: \"flex\", justifyContent: \"center\" }}>\n            <div style={{ width: \"100%\", maxWidth: \"720px\" }}>\n              <Box\n                sx={{\n                  display: \"flex\",\n                  marginBottom: \"20px\",\n                  marginTop: \"20px\",\n                }}\n              >\n                <CustomizedSlider\n                  duration={duration}\n                  videoPieceTime={videoPieceTime}\n                  handleSlideChange={handleSlideChange}\n                />\n                {/* <Slider\n                  min={0}\n                  max={duration}\n                  value={videoPieceTime}\n                  valueLabelDisplay=\"auto\"\n                  valueLabelFormat={(s) => {\n                    return formatTimeSlice(s);\n                  }}\n                  onChange={handleSlideChange}\n                /> */}\n              </Box>\n              <Box\n                sx={{\n                  marginBottom: 2,\n                  display: \"flex\",\n                  justifyContent: \"space-between\",\n                }}\n              >\n                <div>{formatTimeSlice(rowSelected?.startTime)}</div>\n\n                <div>{formatTimeSlice(rowSelected?.endTime)}</div>\n              </Box>\n              {/* <Box\n                sx={{\n                  marginBottom: 2,\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                }}\n              >\n                <Button\n                  variant=\"contained\"\n                  onClick={handleDownloadOneClick}\n                  color=\"secondary\"\n                >\n                  Download\n                </Button>\n              </Box> */}\n            </div>\n          </Grid>\n          <Grid item xs={12}></Grid>\n        </Grid>\n        <Grid item xs={5} overflow=\"auto\">\n          <TableEditVideo\n            data={videoSrc}\n            height=\"55vh\"\n            onTableClick={onTableClick}\n            onCheckOne={onCheckOne}\n            onCheckAll={onCheckAll}\n            buttonReview={\n              <Button variant=\"contained\" onClick={handleEditVideo}>\n                Review\n              </Button>\n            }\n          />\n        </Grid>\n      </Grid>\n      <div\n        style={{ height: 3, backgroundColor: \"black\", marginBottom: \"15px\" }}\n      ></div>\n      <HighlightReview\n        getHighlight={getHighlight}\n        highlights={highlights}\n        mode={1}\n        downloadNoMerge={downloadNoMerge}\n      />\n    </>\n  );\n};\n\nexport default VideoInput;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}